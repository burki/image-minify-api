#!/usr/bin/php
<?php

use \Symfony\Component\DependencyInjection\ContainerBuilder;
use \Symfony\Component\DependencyInjection\Loader\YamlFileLoader;
use \Symfony\Component\Config\FileLocator;

require_once __DIR__ . '/../vendor/autoload.php';

$container = new ContainerBuilder();
$loader = new YamlFileLoader($container, new FileLocator(__DIR__ . '/../config'));
$loader->load('services.yml');

/** @var \Doctrine\DBAL\Driver\Connection $db */
$db = $container->get('dbConnection');

$dump = file_get_contents(__DIR__ . '/../config/db.sql');

$statement = $db->prepare($dump);
$statement->execute();

$climate = new \League\CLImate\CLImate();
$climate->addArt(__DIR__);

if($statement->errorCode() != 0) {
    $climate->draw('oops');
    $climate->border();
    $climate->red()->out('Error while creating Database');
    exit;
}

$climate->grren()->draw('success');
$climate->green()->out('Database created successfully');